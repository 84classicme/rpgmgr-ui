<div class="card">
  <h2>Spells</h2>
  <p-table [value]="spells" [resizableColumns]="true" [autoLayout]="true" [globalFilterFields]="['name','data.school.value','data.range.value']" 
    styleClass="p-datatable-gridlines" sortField="data.level.value" sortMode="single" dataKey="data.level.value" rowGroupMode="subheader" groupRowsBy="data.level.value">
    <ng-template pTemplate="header">
        <tr>
          <th>
            <div class="p-d-flex p-jc-between p-ai-center">
              Name
              <p-columnFilter type="text" field="name" display="menu"></p-columnFilter>
            </div>
          </th>
          <th>
            <div class="p-d-flex p-jc-between p-ai-center">
              School
              <p-columnFilter type="text" field="data.school.value" display="menu"></p-columnFilter>
            </div>
          </th>
          <th>Traditions</th>
          <th>Duration</th>
          <th>
            <div class="p-d-flex p-jc-between p-ai-center">
              Range
              <p-columnFilter type="text" field="data.range.value" display="menu"></p-columnFilter>
            </div>
          </th>
          <th>Area</th>
          <th>Areasize</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="groupheader" let-spell let-rowIndex="rowIndex" let-expanded="expanded">
      <tr>
          <td colspan="7">
            <button type="button" pButton pRipple [pRowToggler]="spell" class="p-button-text p-button-rounded p-button-plain p-mr-2" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
              <span class="p-text-bold p-ml-2">Level {{spell.data.level.value}}</span>
          </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="rowexpansion" let-spell>
      <tr>
        <td>
            {{spell.name}}
        </td>
        <td>
          {{spell.data.school?.value}}
      </td>
        <td>
            {{spell.data.traditions?.value}}
        </td>
        <td>
          {{spell.data.duration?.value}}
      </td>
        <td>
            {{spell.data.range?.value}}
        </td>
        <td>
          {{spell.data.area?.areaType}} {{spell.data.area?.value}}
      </td>
      <td>
          {{spell.data.areasize?.value}}
      </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<div *ngIf="selectedSpell">
  <h2>{{selectedSpell.name | uppercase}} Details</h2>
  <div><span>Description: </span>{{selectedSpell.data.description.value}}</div>
</div>
    