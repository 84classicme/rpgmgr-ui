<mat-stepper orientation="vertical" [linear]="isLinear" #stepper>
    <mat-step [stepControl]="raceFG">
        <form [formGroup]="raceFG">
        <ng-template matStepLabel>Choose your race</ng-template>
        <mat-form-field appearance="fill">
            <mat-label>Race</mat-label>
            <mat-select formControlName="race" class="form-control" required>
                <mat-option *ngFor="let race of races" [value]="race.name">{{ race.name }}</mat-option>
            </mat-select>
        </mat-form-field>
        <div>
            <button mat-button matStepperNext (click)="saveRace()">Next</button>
        </div>
        </form>
    </mat-step>
    <mat-step [stepControl]="classFG" label="Choose your class">
        <form [formGroup]="classFG">
        <mat-form-field appearance="fill">
            <mat-label>Class</mat-label>
            <mat-select formControlName="class" class="form-control" required>
                <mat-option *ngFor="let class of classes" [value]="class.name">{{ class.name }}</mat-option>
            </mat-select>
        </mat-form-field>
        <div>
            <button mat-button matStepperPrevious>Back</button>
            <button mat-button matStepperNext (click)="saveClass()">Next</button>
        </div>
        </form>
    </mat-step>
    <mat-step [stepControl]="abilitiesFG" label="Determine your ability scores">
        <form [formGroup]="abilitiesFG">
            <input matInput formControlName="str" hidden>
            <input matInput formControlName="dex" hidden>
            <input matInput formControlName="con" hidden>
            <input matInput formControlName="int" hidden>
            <input matInput formControlName="wis" hidden>
            <input matInput formControlName="cha" hidden>
            <div cdkDropListGroup>
                <div class="ability-array-container">
                    <div class="ability-container-header">Scores</div> 
                    <div class="ability-list-container">
                        <div
                            cdkDropList
                            id="array"
                            class="ability-array-list"
                            [cdkDropListData]="abilities"
                            (cdkDropListDropped)="addAbility($event)">
                            <div class="ability-box" *ngFor="let item of abilities" cdkDrag>{{item}}</div>
                        </div>
                    </div>
                </div>
                <div class="ability-scores-container">
                    <div class="ability-container">
                        <div class="ability-header">Strength</div>
                        <div class="ability-list-container">
                            <div
                                cdkDropList
                                id="str"
                                class="ability-list"
                                [cdkDropListData]="str"
                                (cdkDropListDropped)="addAbility($event)">
                                <div class="ability-box" *ngFor="let item of str" cdkDrag>{{item}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="ability-container">
                        <div class="ability-header">Dexterity</div>
                        <div class="ability-list-container">
                            <div
                                cdkDropList
                                id="dex"
                                class="ability-list"
                                [cdkDropListData]="dex"
                                (cdkDropListDropped)="addAbility($event)">
                                <div class="ability-box" *ngFor="let item of dex" cdkDrag>{{item}}</div>
                            </div>
                        </div>
                    </div>    
                    <div class="ability-container">
                        <div class="ability-header">Constitution</div>
                        <div class="ability-list-container">
                            <div
                                cdkDropList
                                id="con"
                                class="ability-list"
                                [cdkDropListData]="con"
                                (cdkDropListDropped)="addAbility($event)">
                                <div class="ability-box" *ngFor="let item of con" cdkDrag>{{item}}</div>
                            </div>
                        </div>
                    </div>
                        <div class="ability-container">
                        <div class="ability-header">Intelligence</div>
                        <div class="ability-list-container">
                            <div
                                cdkDropList
                                id="int"
                                class="ability-list"
                                [cdkDropListData]="int"
                                (cdkDropListDropped)="addAbility($event)">
                                <div class="ability-box" *ngFor="let item of int" cdkDrag>{{item}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="ability-container">
                        <div class="ability-header">Wisdom</div>
                        <div class="ability-list-container">
                            <div
                                cdkDropList
                                id="wis"
                                class="ability-list"
                                [cdkDropListData]="wis"
                                (cdkDropListDropped)="addAbility($event)">
                                <div class="ability-box" *ngFor="let item of wis" cdkDrag>{{item}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="ability-container">
                        <div class="ability-header">Charisma</div>
                        <div class="ability-list-container">
                            <div
                                cdkDropList
                                id="cha"
                                class="ability-list"
                                [cdkDropListData]="cha"
                                (cdkDropListDropped)="addAbility($event)">
                                <div class="ability-box" *ngFor="let item of cha" cdkDrag>{{item}}</div>
                            </div> 
                        </div>
                    </div>  
                </div>              
            </div>
            <div>
                <button mat-button matStepperPrevious>Back</button>
                <button mat-button matStepperNext (click)="saveAbilities()">Next</button>
            </div>  
        </form>
    </mat-step>   
    <mat-step [stepControl]="descriptionFG" label="Describe your character">
        <form [formGroup]="descriptionFG">
            <h3>Appearance</h3>
            <mat-form-field appearance="fill">
                <mat-label>Height</mat-label>
                <input matInput placeholder="Height" formControlName="height">
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Weight</mat-label>
                <input matInput placeholder="Weight" formControlName="weight">
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Hair Color</mat-label>
                <input matInput placeholder="Height" formControlName="hair">
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Eye Color</mat-label>
                <input matInput placeholder="Weight" formControlName="eyes">
            </mat-form-field>
            <h3>Outlook</h3>
            <mat-form-field appearance="fill">
                <mat-label>Deity</mat-label>
                <input matInput placeholder="Deity" formControlName="deity">
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Alignment</mat-label>
                <mat-select formControlName="alignment" class="form-control" required>
                    <mat-option *ngFor="let alignment of alignments" [value]="alignment.name">{{ alignment.name }}</mat-option>
                </mat-select>
            </mat-form-field>
            <h3>Background</h3>
            <h4>Skills</h4>
            <mat-form-field appearance="fill">
                <mat-label>First Skill</mat-label>
                <mat-select formControlName="skill1" class="form-control" required>
                    <mat-option *ngFor="let skill of skills" [value]="skill.reference.name">{{ skill.reference.name }}</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Second Skill</mat-label>
                <mat-select formControlName="skill2" class="form-control" required>
                    <mat-option *ngFor="let skill of skills" [value]="skill.reference.name">{{ skill.reference.name }}</mat-option>
                </mat-select>
            </mat-form-field>
            <h4>Other Proficiences (choose any 2)</h4>
            <mat-form-field appearance="fill">
                <mat-label>Artisan's Tools</mat-label>
                <mat-select formControlName="artisantools" class="form-control">
                    <mat-option *ngFor="let tool of tools" [value]="tool.name">{{ tool.name }}</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Other Tools</mat-label>
                <mat-select formControlName="othertools" class="form-control">
                    <mat-option *ngFor="let other of others" [value]="other.name">{{ other.name }}</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Languages</mat-label>
                <mat-select formControlName="languages" class="form-control">
                    <mat-option *ngFor="let language of languages" [value]="language.name">{{ language.name }}</mat-option>
                </mat-select>
            </mat-form-field>
            <div>
                <button mat-button matStepperPrevious>Back</button>
                <button mat-button matStepperNext (click)="saveDescription()">Next</button>
            </div>
        </form>
    </mat-step>   
    <mat-step [stepControl]="equipmentFG" label="Equip your character">
        <form [formGroup]="equipmentFG">
            <div *ngIf=selectedClass.starting_equipment>
                The {{ selectedClass.name }} starts with the following equipment:
                <ul *ngFor="let item of selectedClass.starting_equipment">
                    <li>{{ item.equipment.name }}</li>
                </ul>
            </div>
            <div *ngIf=selectedClass.starting_equipment_options>
                <div formArrayName="eqOptions">
                    You also get to choose from the following options:
                    <div *ngFor="let option of selectedClass.starting_equipment_options; index as idx">
                        <div>Choose {{ option.choose }} items from the following {{ option.type }}</div>
                        <mat-button-toggle-group [formControlName]="idx" >
                            <mat-button-toggle *ngFor="let itemoption of option?.from" [value]="itemoption.equipment?.name">
                                {{itemoption.equipment.name}}
                            </mat-button-toggle>
                        </mat-button-toggle-group>
                    </div>
                </div>
            </div>    
            <div>
                <button mat-button matStepperPrevious>Back</button>
                <button mat-button matStepperNext (click)="saveEquipment()">Next</button>
            </div>
        </form>
    </mat-step>
    <mat-step [stepControl]="confirmationFG" label="Confirm you choices">
        <form [formGroup]="confirmationFG">
            <table>
                <tr>
                    <td>Race</td>
                    <td> {{ character.race.name }}</td>
                </tr>
                <tr>
                    <td>Class</td>
                    <td> {{ character.class.name }}</td>
                </tr>
                <tr>
                    <td>Race</td>
                    <td> {{ character.race.name }}</td>
                </tr>
                <tr>
                    <td>Strength</td>
                    <td> {{ character.str }}</td>
                </tr>
                <tr>
                    <td>Dexterity</td>
                    <td> {{ character.dex }}</td>
                </tr>
                <tr>
                    <td>Constituion</td>
                    <td> {{ character.con }}</td>
                </tr>
                <tr>
                    <td>Intelligence</td>
                    <td> {{ character.int }}</td>
                </tr>
                <tr>
                    <td>Wisdom</td>
                    <td> {{ character.wis }}</td>
                </tr>
                <tr>
                    <td>Charisma</td>
                    <td> {{ character.cha}}</td>
                </tr>
            </table>
            <div>
                <button mat-button matStepperPrevious>Back</button>
                <button mat-button matStepperNext>Confirm</button>
            </div>
        </form>
    </mat-step>
    <mat-step>
        <ng-template matStepLabel>Done</ng-template>
        <p>You are now done.</p>
        <div>
        <!-- <button mat-button matStepperPrevious>Back</button>
        <button mat-button (click)="stepper.reset()">Reset</button> -->
        </div>
    </mat-step>
</mat-stepper>
  